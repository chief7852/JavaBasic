package service;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import util.PrintUtil;
import util.ScanUtil;
import util.View;
import controller.Controller;
import dao.BoardDao;

public class BoardService {
	
	private static BoardService instance;
	private BoardService(){}
	public static BoardService getInstance(){
		if(instance == null){
			instance = new BoardService();
		}
		return instance;
	}
	
	private BoardDao boardDao = BoardDao.getInstance();
	
	private int currentBoardNo;
	
	
	public int boardList()
	{
		int select = 1;
		
		boar:while(true)
		{
		List<Map<String,Object>> boardList = boardDao.selectBoardList();
		PrintUtil.title();
		System.out.println("ë§ë¨¸ë¦¬\tì œëª©\t\tì‘ì„±ì\tì‘ì„±ì¼");
		System.out.println("-------------------------------------");
		for(int i=0; i< boardList.size(); i++){
			Map<String, Object> board = boardList.get(i);
			String title = (String)board.get("TITLE");
			if(title.length()>3)
			{
				title = title.substring(0, 3) + "..";
			}
			System.out.println( board.get("CATEGORY") + "\t"
					+title + "\t\t"
					+board.get("NICKNAME") + "\t"
					+board.get("SUBSTR(A.B_DATE,1,10)"));
		}
		

		
		
		if(select == 1|| select == 5)
		{
			System.out.print( "\tâ– ê²Œì‹œê¸€ ì¡°íšŒ  ");
			System.out.print( "â–¡ê²Œì‹œê¸€ ì‘ì„±  ");
			System.out.print( "â–¡ì‹ë‹¹ë¬¸ì˜  ");			
			System.out.print( "â–¡ë’¤ë¡œê°€ê¸°");
			System.out.println();
		}
		if(select == 2)
		{
			System.out.print( "\tâ–¡ê²Œì‹œê¸€ ì¡°íšŒ  ");
			System.out.print( "â– ê²Œì‹œê¸€ ì‘ì„±  ");
			System.out.print( "â–¡ì‹ë‹¹ë¬¸ì˜  ");	
			System.out.print( "â–¡ë’¤ë¡œê°€ê¸°");
			System.out.println();
		}
		if(select == 3)
		{
			System.out.print( "\tâ–¡ê²Œì‹œê¸€ ì¡°íšŒ  ");
			System.out.print( "â–¡ê²Œì‹œê¸€ ì‘ì„±  ");
			System.out.print( "â– ì‹ë‹¹ë¬¸ì˜  ");	
			System.out.print( "â–¡ë’¤ë¡œê°€ê¸°");
			System.out.println();
		}
		if(select == 4||select == 0)
		{
			System.out.print( "\tâ–¡ê²Œì‹œê¸€ ì¡°íšŒ  ");
			System.out.print( "â–¡ê²Œì‹œê¸€ ì‘ì„±  ");
			System.out.print( "â–¡ì‹ë‹¹ë¬¸ì˜  ");	
			System.out.print( "â– ë’¤ë¡œê°€ê¸°");
			System.out.println();
		}
		if(select ==5){select = 1;}
		if(select ==0){select = 4;}
		System.out.print("\n                           (1,3)â† â†’ (â)í™•ì¸ \n");
		System.out.print("â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– â–¡â– \n>");
		String input = ScanUtil.nextLine();
		
		switch(input)
		{
		case "3" : select++;break;
		case "1" : select--;break;
		case "" : break boar;
		}
		
		}
		
		
		if(select == 1)
		{
			System.out.print("ê²Œì‹œê¸€ ë²ˆí˜¸ ì…ë ¥ >");
			currentBoardNo=ScanUtil.nextInt();
			return View.BOARD_MANAGE;
		}
		
		if(select == 2)
		{
			if(Controller.user.get("USER_ID").toString().equals("guest"))
			{   System.out.println();
				System.out.println("ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤");
				System.out.println();
				System.out.println("[Enter] í‚¤ë¥¼ ëˆ„ë¥´ì„¸ìš”");
				String temp = ScanUtil.nextLine();
				return View.SIGNUP;}
			return View.BOARD_ADD;
		}
		if(select == 3)
		{
			
		}
		if(select == 4)
		{
			Controller.user = null;
			return View.USER_MAIN;
			
		}else return View.BOARD_MAIN;
		
		}
	
		
	
	
		//ê²Œì‹œíŒ ê¸€ì“°ê¸°
	public int boardAdd()
	{
		String userId=Controller.user.get("USER_ID").toString();
		String nickName = Controller.user.get("NICKNAME").toString();
		
		String cateGory = "" , tiTle = "" , conTent = "";
		if(userId == "admin") {cateGory = "ê³µì§€ì‚¬í•­";}
		else {cateGory = "ê±´ì˜ì‚¬í•­";}
		
		
		Add:while(true)
		{
		
		check:while(true){
			
		
		PrintUtil.title();
		System.out.println("  ğŸ“„ê±´ì˜ì‚¬í•­âœï¸");
		System.out.print("ì œëª©\t: " + tiTle + "\n");
		System.out.print("ë‚´ìš©\t: " + conTent + "\n");
		System.out.println("\t\t   ë’¤ë¡œ ê°€ëŸ¬ë©´ [Enter] í‚¤ë¥¼ ëˆ„ë¥´ì„¸ìš”");
		PrintUtil.printBar();
		
		
		
		
		if (tiTle == ""){
			System.out.print("ì œëª© : ");
			tiTle = ScanUtil.nextLine();
		}
		else if(conTent ==""){
		System.out.print("ë‚´ìš© : ");
			conTent = ScanUtil.nextLine();
				break check;
		}
		
		}
		    
			Map<String, Object> param = new HashMap<String, Object>();
			
			param.put("TITLE", tiTle);
			param.put("USER_ID",userId);
			param.put("CONTENT", conTent);
			param.put("CATEGORY", cateGory);
			int result = boardDao.centerBoardAdd(param);
			
			if(0 < result){
				System.out.println("ê¸€ ë“±ë¡ ì„±ê³µ");
				return View.BOARD_MAIN;	
			}else{
				System.out.println("ê¸€ ë“±ë¡ ì‹¤íŒ¨");
				return View.BOARD_MAIN;	
			}
		}
	
	}
	
	
	public int boardSelect(){
		
		
		return currentBoardNo;
		
	}
	
	
	
	
	
}